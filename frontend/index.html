<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yoga Pose Correction</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üßò Yoga Pose Correction</h1>
            <p>Upload a video or use your webcam to analyze your yoga pose</p>
        </header>

        <main>
            <!-- Tab Navigation -->
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('video')">üìπ Upload Video</button>
                <button class="tab-btn" onclick="switchTab('webcam')">üì∑ Live Webcam</button>
            </div>

            <!-- Video Upload Section -->
            <div id="video-tab" class="tab-content active">
                <div class="upload-section">
                    <div class="pose-selection">
                        <label for="poseSelect"><strong>Select the Asana in your video:</strong></label>
                        <select id="poseSelect" class="pose-dropdown">
                            <option value="">-- Select Asana --</option>
                            <option value="Anantasana">Anantasana (Side Reclining Leg Lift)</option>
                            <option value="Ardhakati Chakrasana">Ardhakati Chakrasana (Standing Side Bend)</option>
                            <option value="Bhujangasana">Bhujangasana (Cobra Pose)</option>
                            <option value="Kati Chakrasana">Kati Chakrasana (Standing Spinal Twist)</option>
                            <option value="Marjariasana">Marjariasana (Cat Pose)</option>
                            <option value="Parvatasana">Parvatasana (Downward Facing Dog)</option>
                            <option value="Sarvangasana">Sarvangasana (Shoulder Stand)</option>
                            <option value="Tadasana">Tadasana (Mountain Pose)</option>
                            <option value="Vajrasana">Vajrasana (Thunderbolt Pose)</option>
                            <option value="Viparita Karani">Viparita Karani (Legs Up the Wall)</option>
                        </select>
                    </div>

                    <div class="upload-box" id="uploadBox">
                        <input type="file" id="videoInput" accept="video/*" hidden>
                        <label for="videoInput" class="upload-label">
                            <div class="upload-icon">üì§</div>
                            <h3>Choose Video File</h3>
                            <p>or drag and drop here</p>
                            <p class="file-info">MP4, AVI, MOV supported</p>
                        </label>
                    </div>
                    
                    <div id="selectedFile" class="selected-file" style="display: none;">
                        <p>Selected: <span id="fileName"></span></p>
                        <button onclick="analyzeVideo()" class="btn-primary">Analyze Pose</button>
                    </div>
                </div>

                <div id="videoPreview" class="preview-section" style="display: none;">
                    <h3>Video Preview</h3>
                    <video id="videoPlayer" controls></video>
                </div>
            </div>

            <!-- Webcam Section -->
            <div id="webcam-tab" class="tab-content">
                <div class="webcam-section">
                    <div class="webcam-container">
                        <video id="webcam" autoplay playsinline></video>
                        <canvas id="canvas" style="display: none;"></canvas>
                    </div>
                    
                    <div class="webcam-controls">
                        <button id="startWebcam" onclick="startWebcam()" class="btn-primary">Start Webcam</button>
                        <button id="captureBtn" onclick="captureAndAnalyze()" class="btn-secondary" style="display: none;">Capture & Analyze</button>
                        <button id="stopWebcam" onclick="stopWebcam()" class="btn-danger" style="display: none;">Stop Webcam</button>
                    </div>
                </div>
            </div>

            <!-- Loading Spinner -->
            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Analyzing your pose...</p>
            </div>

            <!-- Results Section -->
            <div id="results" class="results-section" style="display: none;">
                <div class="results-header">
                    <h2 id="asanaName" class="asana-title">Tadasana</h2>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üéØ</div>
                        <p class="stat-value" id="accuracy">--</p>
                        <h3>Accuracy</h3>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úì</div>
                        <p class="stat-value" id="correctFrames">--</p>
                        <h3>Correct</h3>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üß†</div>
                        <p class="stat-value" id="confidence">--</p>
                        <h3>Confidence</h3>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìπ</div>
                        <p class="stat-value" id="framesCount">--</p>
                        <h3>Frames</h3>
                    </div>
                </div>

                <!-- Status Banner -->
                <div id="statusBanner" class="status-banner status-excellent">
                    <span class="status-icon">‚úì</span>
                    <span class="status-text" id="statusText">Excellent</span>
                </div>

                <!-- Overall Feedback -->
                <div class="feedback-section">
                    <h3>Overall Feedback:</h3>
                    <div class="feedback-text" id="overallFeedback"></div>
                </div>

                <!-- Video Analysis Section -->
                <div class="video-analysis-section">
                    <div class="video-analysis-header">
                        <span class="video-icon">‚ñ∂Ô∏è</span>
                        <h3>Video Analysis</h3>
                    </div>
                    <div class="video-display-area">
                        <div class="video-frame-container">
                            <img id="currentFrameImage" src="" alt="Current Frame" class="current-frame-image">
                            <div class="video-feedback-overlay">
                                <div class="feedback-badge" id="frameFeedbackBadge">
                                    Ready to analyze
                                </div>
                            </div>
                            <div class="video-controls-overlay">
                                <div class="frame-counter" id="frameCounter">Frame 1/1</div>
                                <div class="playback-controls">
                                    <button class="control-btn" id="prevFrameBtn" onclick="previousFrame()">
                                        <span>‚èÆ</span>
                                    </button>
                                    <button class="control-btn play-btn" id="playBtn" onclick="playFrameSequence()">
                                        <span>‚ñ∂</span>
                                    </button>
                                    <button class="control-btn" id="nextFrameBtn" onclick="nextFrame()">
                                        <span>‚è≠</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progressBar"></div>
                        </div>
                    </div>
                </div>

                <!-- Frame-by-Frame Analysis -->
                <div class="frame-details">
                    <h3>Frame Analysis:</h3>
                    <div id="frameResults" class="frame-list"></div>
                    <button id="toggleFramesBtn" class="toggle-frames-btn" style="display: none;" onclick="toggleFrames()">
                        <span id="toggleIcon">‚ñº</span>
                        <span id="toggleText">+ 0 more frames</span>
                    </button>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="btn-primary" onclick="retakeVideo()">Retake Video</button>
                    <button class="btn-secondary-outline" onclick="backToHome()">Back to Home</button>
                </div>
            </div>
        </main>

        <footer>
            <p>Powered by TensorFlow & FastAPI</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
